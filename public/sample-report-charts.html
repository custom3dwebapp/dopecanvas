<!DOCTYPE html>
<html>
<head>
<style>
  h1 { color: #1a1a2e; font-family: Georgia, serif; font-size: 26px; margin-bottom: 4px; }
  h2 { color: #16213e; font-family: Georgia, serif; margin-top: 20px; font-size: 20px; }
  h3 { color: #2d3436; font-family: Georgia, serif; margin-top: 16px; font-size: 16px; }
  p  { line-height: 1.7; color: #333; font-size: 14px; }
  table { width: 100%; border-collapse: collapse; font-size: 13px; }
  thead tr { background: #1a1a2e; color: #fff; }
  th, td { padding: 8px 12px; text-align: left; }
  th { font-weight: 600; }
  tbody tr:nth-child(even) { background: #f8f9fa; }
  tbody td { border-bottom: 1px solid #dee2e6; }
  td.num { text-align: right; font-variant-numeric: tabular-nums; }
  th.num { text-align: right; }
  tr.total-row { background: #eef2ff !important; font-weight: bold; }
  tr.total-row td { border-top: 2px solid #1a1a2e; border-bottom: 2px solid #1a1a2e; }
  .fx { color: #6c5ce7; cursor: default; }
  .chart-container { margin: 16px auto; text-align: center; }
  .chart-container canvas { max-width: 100%; }
  .kpi-grid { display: flex; gap: 12px; margin: 16px 0; }
  .kpi-card {
    flex: 1; padding: 14px 16px; border-radius: 8px; text-align: center;
    border: 1px solid #e0e0e0; background: #fafbfc;
  }
  .kpi-value { font-size: 24px; font-weight: 700; color: #1a1a2e; margin-bottom: 2px; }
  .kpi-label { font-size: 11px; color: #888; text-transform: uppercase; letter-spacing: 0.5px; }
  .kpi-delta { font-size: 12px; margin-top: 4px; }
  .kpi-up { color: #00b894; }
  .kpi-down { color: #d63031; }
  .note { font-size: 12px; color: #888; margin-top: 8px; }
  .badge {
    display: inline-block; padding: 2px 8px; border-radius: 10px;
    font-size: 11px; font-weight: 600;
  }
  .badge-green { background: #e6f9f0; color: #00b894; }
  .badge-red   { background: #ffeaea; color: #d63031; }
  .badge-blue  { background: #eef2ff; color: #6c5ce7; }
</style>
</head>
<body>

<h1>NovaTech Inc — Annual Sales Report 2025</h1>
<p style="color: #666; font-size: 13px; margin-top: 0; border-bottom: 2px solid #1a1a2e; padding-bottom: 10px;">
  Revenue Analytics · Fiscal Year 2025 · Confidential
</p>

<h2>Executive Summary</h2>
<p>
  NovaTech Inc achieved record revenue in FY2025, driven primarily
  by the Enterprise SaaS platform and expansion into the Asia-Pacific market.
  Gross margins improved to 72.4% (up from 68.1%) as cloud infrastructure costs were optimised.
  Operating expenses grew at a controlled 15%, resulting in an EBITDA margin of 28.3%.
</p>

<div class="kpi-grid">
  <div class="kpi-card">
    <div class="kpi-value fx" id="kpi-revenue">$48.2M</div>
    <div class="kpi-label">Total Revenue</div>
    <div class="kpi-delta fx" id="kpi-revenue-delta">▲ 23% YoY</div>
  </div>
  <div class="kpi-card">
    <div class="kpi-value">72.4%</div>
    <div class="kpi-label">Gross Margin</div>
    <div class="kpi-delta kpi-up">▲ 4.3pp</div>
  </div>
  <div class="kpi-card">
    <div class="kpi-value">28.3%</div>
    <div class="kpi-label">EBITDA Margin</div>
    <div class="kpi-delta kpi-up">▲ 5.1pp</div>
  </div>
  <div class="kpi-card">
    <div class="kpi-value fx" id="kpi-customers">1,247</div>
    <div class="kpi-label">Active Customers</div>
    <div class="kpi-delta fx" id="kpi-customers-delta">▲ 18%</div>
  </div>
</div>

<p class="note">
  Cells in <span class="fx">purple</span> are computed automatically — edit any data cell and totals, percentages, charts, and KPIs all update in real time.
</p>

<div style="break-before: page;"></div>

<h2>Quarterly Revenue Breakdown</h2>
<p>
  Revenue accelerated through the year. The chart below compares FY2024 and FY2025
  quarterly performance side by side. Edit any revenue cell in the table and the chart,
  totals, and growth percentages will recalculate instantly.
</p>

<div class="chart-container">
  <canvas id="quarterlyChart" width="560" height="300"></canvas>
</div>

<table id="quarterly-table">
  <thead>
    <tr>
      <th>Quarter</th>
      <th class="num">FY2024</th>
      <th class="num">FY2025</th>
      <th class="num">Growth</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Q1 (Jan–Mar)</td>
      <td class="num">$8.1M</td>
      <td class="num">$9.8M</td>
      <td class="num fx" data-fx="growth">+21%</td>
      <td class="fx" data-fx="status"><span class="badge badge-green">Above Target</span></td>
    </tr>
    <tr>
      <td>Q2 (Apr–Jun)</td>
      <td class="num">$9.4M</td>
      <td class="num">$11.2M</td>
      <td class="num fx" data-fx="growth">+19%</td>
      <td class="fx" data-fx="status"><span class="badge badge-green">Above Target</span></td>
    </tr>
    <tr>
      <td>Q3 (Jul–Sep)</td>
      <td class="num">$9.8M</td>
      <td class="num">$12.6M</td>
      <td class="num fx" data-fx="growth">+29%</td>
      <td class="fx" data-fx="status"><span class="badge badge-green">Above Target</span></td>
    </tr>
    <tr>
      <td>Q4 (Oct–Dec)</td>
      <td class="num">$11.9M</td>
      <td class="num">$14.6M</td>
      <td class="num fx" data-fx="growth">+23%</td>
      <td class="fx" data-fx="status"><span class="badge badge-green">Above Target</span></td>
    </tr>
    <tr class="total-row">
      <td class="fx">Full Year</td>
      <td class="num fx" id="q-total-fy24">$39.2M</td>
      <td class="num fx" id="q-total-fy25">$48.2M</td>
      <td class="num fx" id="q-total-growth">+23%</td>
      <td class="fx"><span class="badge badge-blue">Record</span></td>
    </tr>
  </tbody>
</table>

<div style="break-before: page;"></div>

<h2>Monthly Revenue Trend</h2>
<p>
  The monthly view reveals a consistent upward trajectory with seasonal peaks in March (end of Q1
  enterprise buying cycle), June, and a strong finish in November–December. The trendline shows
  healthy compound monthly growth of approximately 1.8%.
</p>

<div class="chart-container">
  <canvas id="monthlyChart" width="560" height="280"></canvas>
</div>

<h3>Key Monthly Highlights</h3>
<p>
  <strong>March ($3.6M):</strong> Record single-month revenue driven by 12 enterprise deals closing
  before end-of-quarter deadlines. Average deal size increased 40% compared to prior year.<br>
  <strong>August ($3.5M):</strong> Typically a slower month, but APAC expansion contributed an
  incremental $0.9M. The region is now self-sustaining with a dedicated sales team of 18.<br>
  <strong>December ($5.2M):</strong> All-time monthly record. Annual renewals, new logos, and a
  successful Black Friday promotion for the self-serve tier combined for a blowout finish.
</p>

<div style="break-before: page;"></div>

<h2>Revenue by Product Line</h2>
<p>
  The Enterprise SaaS platform remains the dominant revenue driver. Edit any product revenue cell
  below and the doughnut chart, percentage shares, and total will update automatically.
</p>

<div class="chart-container">
  <canvas id="productChart" width="420" height="300"></canvas>
</div>

<table id="product-table">
  <thead>
    <tr>
      <th>Product Line</th>
      <th class="num">Revenue</th>
      <th class="num">% of Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Enterprise SaaS</td>
      <td class="num">$25.1M</td>
      <td class="num fx" data-fx="pct">52%</td>
    </tr>
    <tr>
      <td>Pro (Self-Serve)</td>
      <td class="num">$12.5M</td>
      <td class="num fx" data-fx="pct">26%</td>
    </tr>
    <tr>
      <td>Professional Services</td>
      <td class="num">$6.3M</td>
      <td class="num fx" data-fx="pct">13%</td>
    </tr>
    <tr>
      <td>Marketplace &amp; Add-ons</td>
      <td class="num">$4.3M</td>
      <td class="num fx" data-fx="pct">9%</td>
    </tr>
    <tr class="total-row">
      <td class="fx">Total</td>
      <td class="num fx" id="p-total-rev">$48.2M</td>
      <td class="num fx">100%</td>
    </tr>
  </tbody>
</table>

<div style="break-before: page;"></div>

<h2>Regional Performance</h2>
<p>
  North America continues to be the primary market. Edit revenue or customer counts below and
  the chart, average deal sizes, and totals will update instantly.
</p>

<div class="chart-container">
  <canvas id="regionChart" width="560" height="280"></canvas>
</div>

<table id="region-table">
  <thead>
    <tr>
      <th>Region</th>
      <th class="num">Revenue</th>
      <th class="num">Customers</th>
      <th class="num">Avg Deal Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>North America</td>
      <td class="num">$27.9M</td>
      <td class="num">612</td>
      <td class="num fx" data-fx="deal">$45.6K</td>
    </tr>
    <tr>
      <td>EMEA</td>
      <td class="num">$10.4M</td>
      <td class="num">348</td>
      <td class="num fx" data-fx="deal">$29.9K</td>
    </tr>
    <tr>
      <td>Asia-Pacific</td>
      <td class="num">$6.8M</td>
      <td class="num">198</td>
      <td class="num fx" data-fx="deal">$34.3K</td>
    </tr>
    <tr>
      <td>Latin America</td>
      <td class="num">$3.1M</td>
      <td class="num">89</td>
      <td class="num fx" data-fx="deal">$34.8K</td>
    </tr>
    <tr class="total-row">
      <td class="fx">Global</td>
      <td class="num fx" id="r-total-rev">$48.2M</td>
      <td class="num fx" id="r-total-cust">1,247</td>
      <td class="num fx" id="r-total-deal">$38.7K</td>
    </tr>
  </tbody>
</table>

<p class="note">
  All figures are unaudited and subject to final reconciliation.
  Edit any non-purple cell and all computed fields, totals, and charts refresh automatically.
</p>

<script>
(function () {
  /* ================================================================
   * REACTIVE DATA ENGINE
   * ────────────────────
   * • Reads raw data FROM the table cells (source of truth)
   * • Recomputes totals, growth %, deal sizes, percentages
   * • Pushes updated data into Chart.js instances
   * • Updates KPI cards on page 1
   * ================================================================ */

  /* ── Helpers ── */
  function parseNum(text) {
    var s = (text || '').replace(/[,$\s%+▲▼]/g, '').trim();
    if (!s || s === '—' || s.toLowerCase() === 'new') return 0;
    var mul = 1;
    if (/m$/i.test(s)) { mul = 1e6; s = s.slice(0, -1); }
    else if (/k$/i.test(s)) { mul = 1e3; s = s.slice(0, -1); }
    s = s.replace(/[^0-9.\-]/g, '');
    var n = parseFloat(s);
    return isNaN(n) ? 0 : n * mul;
  }
  function fmtM(v)  { return '$' + (v / 1e6).toFixed(1) + 'M'; }
  function fmtK(v)  { return '$' + (v / 1e3).toFixed(1) + 'K'; }
  function fmtPct(v) { return (v >= 0 ? '+' : '') + Math.round(v) + '%'; }
  function fmtInt(v) { return Math.round(v).toLocaleString(); }

  function growthBadge(pct) {
    if (pct >= 15) return '<span class="badge badge-green">Above Target</span>';
    if (pct >= 0)  return '<span class="badge badge-blue">On Target</span>';
    return '<span class="badge badge-red">Below Target</span>';
  }

  /* ── Chart instances (assigned after Chart.js loads) ── */
  var quarterlyChartInst = null;
  var monthlyChartInst   = null;
  var productChartInst   = null;
  var regionChartInst    = null;

  /* ── Lock computed cells ── */
  function lockFx() {
    document.querySelectorAll('[data-fx], .total-row .fx').forEach(function (el) {
      el.contentEditable = 'false';
    });
  }

  /* ================================================================
   * RECALC: QUARTERLY TABLE
   * ================================================================ */
  function recalcQuarterly() {
    var table = document.getElementById('quarterly-table');
    if (!table) return;
    var rows = table.querySelectorAll('tbody tr:not(.total-row)');
    var fy24 = [], fy25 = [], growth = [];
    var sumFy24 = 0, sumFy25 = 0;

    rows.forEach(function (tr) {
      var cells = tr.querySelectorAll('td');
      var v24 = parseNum(cells[1].textContent);
      var v25 = parseNum(cells[2].textContent);
      fy24.push(v24 / 1e6);
      fy25.push(v25 / 1e6);
      sumFy24 += v24;
      sumFy25 += v25;

      /* computed: growth % */
      var g = v24 ? ((v25 - v24) / v24) * 100 : 0;
      growth.push(g);
      cells[3].textContent = fmtPct(g);

      /* computed: status badge */
      cells[4].innerHTML = growthBadge(g);
    });

    /* Total row */
    var totalGrowth = sumFy24 ? ((sumFy25 - sumFy24) / sumFy24) * 100 : 0;
    document.getElementById('q-total-fy24').textContent = fmtM(sumFy24);
    document.getElementById('q-total-fy25').textContent = fmtM(sumFy25);
    document.getElementById('q-total-growth').textContent = fmtPct(totalGrowth);

    /* KPI cards */
    var kpiRev = document.getElementById('kpi-revenue');
    var kpiRevD = document.getElementById('kpi-revenue-delta');
    if (kpiRev) kpiRev.textContent = fmtM(sumFy25);
    if (kpiRevD) {
      kpiRevD.textContent = (totalGrowth >= 0 ? '▲ ' : '▼ ') + Math.abs(Math.round(totalGrowth)) + '% YoY';
      kpiRevD.className = 'kpi-delta fx ' + (totalGrowth >= 0 ? 'kpi-up' : 'kpi-down');
    }

    /* Update chart */
    if (quarterlyChartInst) {
      quarterlyChartInst.data.datasets[0].data = fy24;
      quarterlyChartInst.data.datasets[1].data = fy25;
      quarterlyChartInst.update();
    }
  }

  /* ================================================================
   * RECALC: PRODUCT TABLE
   * ================================================================ */
  function recalcProduct() {
    var table = document.getElementById('product-table');
    if (!table) return;
    var rows = table.querySelectorAll('tbody tr:not(.total-row)');
    var revenues = [];
    var totalRev = 0;

    /* First pass: collect revenues */
    rows.forEach(function (tr) {
      var cells = tr.querySelectorAll('td');
      var rev = parseNum(cells[1].textContent);
      revenues.push(rev);
      totalRev += rev;
    });

    /* Second pass: set computed % */
    rows.forEach(function (tr, i) {
      var cells = tr.querySelectorAll('td');
      var pct = totalRev ? (revenues[i] / totalRev) * 100 : 0;
      cells[2].textContent = Math.round(pct) + '%';
    });

    /* Total row */
    document.getElementById('p-total-rev').textContent = fmtM(totalRev);

    /* Update chart */
    if (productChartInst) {
      productChartInst.data.datasets[0].data = revenues.map(function (r) { return r / 1e6; });
      productChartInst.options.plugins.tooltip.callbacks.label = function (ctx) {
        var tot = totalRev / 1e6;
        return ctx.label + ': $' + ctx.parsed.toFixed(1) + 'M (' + Math.round(ctx.parsed / tot * 100) + '%)';
      };
      productChartInst.update();
    }
  }

  /* ================================================================
   * RECALC: REGION TABLE
   * ================================================================ */
  function recalcRegion() {
    var table = document.getElementById('region-table');
    if (!table) return;
    var rows = table.querySelectorAll('tbody tr:not(.total-row)');
    var revenues = [], customers = [];
    var totalRev = 0, totalCust = 0;

    rows.forEach(function (tr) {
      var cells = tr.querySelectorAll('td');
      var rev  = parseNum(cells[1].textContent);
      var cust = parseNum(cells[2].textContent);
      revenues.push(rev);
      customers.push(cust);
      totalRev  += rev;
      totalCust += cust;

      /* computed: avg deal size */
      var deal = cust ? rev / cust : 0;
      cells[3].textContent = fmtK(deal);
    });

    /* Total row */
    document.getElementById('r-total-rev').textContent  = fmtM(totalRev);
    document.getElementById('r-total-cust').textContent = fmtInt(totalCust);
    document.getElementById('r-total-deal').textContent = fmtK(totalCust ? totalRev / totalCust : 0);

    /* KPI: active customers */
    var kpiCust = document.getElementById('kpi-customers');
    if (kpiCust) kpiCust.textContent = fmtInt(totalCust);

    /* Update chart */
    if (regionChartInst) {
      regionChartInst.data.datasets[0].data = revenues.map(function (r) { return r / 1e6; });
      regionChartInst.update();
    }
  }

  /* ================================================================
   * CREATE CHARTS + BIND EVENTS
   * ================================================================ */
  function init() {
    var Chart = window.Chart;
    if (!Chart) return;

    /* Shared palette */
    var navy   = '#1a1a2e';
    var purple = '#6c5ce7';
    var teal   = '#00b894';
    var coral  = '#e17055';
    var blue   = '#0984e3';
    var grey   = '#b2bec3';

    Chart.defaults.font.family = 'system-ui, -apple-system, BlinkMacSystemFont, sans-serif';
    Chart.defaults.font.size = 12;
    Chart.defaults.plugins.legend.labels.usePointStyle = true;

    /* ── 1. Quarterly Revenue (grouped bar) ── */
    var qCtx = document.getElementById('quarterlyChart');
    if (qCtx) {
      quarterlyChartInst = new Chart(qCtx, {
        type: 'bar',
        data: {
          labels: ['Q1', 'Q2', 'Q3', 'Q4'],
          datasets: [
            { label: 'FY2024', data: [8.1, 9.4, 9.8, 11.9], backgroundColor: grey, borderRadius: 4, barPercentage: 0.7 },
            { label: 'FY2025', data: [9.8, 11.2, 12.6, 14.6], backgroundColor: purple, borderRadius: 4, barPercentage: 0.7 },
          ],
        },
        options: {
          responsive: false,
          animation: { duration: 300 },
          plugins: { title: { display: true, text: 'Quarterly Revenue ($M)', font: { size: 14, weight: '600' }, color: navy } },
          scales: {
            y: { beginAtZero: true, ticks: { callback: function (v) { return '$' + v + 'M'; } }, grid: { color: '#f0f0f0' } },
            x: { grid: { display: false } },
          },
        },
      });
    }

    /* ── 2. Monthly Revenue (line — static, no table) ── */
    var mCtx = document.getElementById('monthlyChart');
    if (mCtx) {
      monthlyChartInst = new Chart(mCtx, {
        type: 'line',
        data: {
          labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
          datasets: [
            { label: 'FY2025', data: [3.0,3.2,3.6,3.5,3.7,4.0,3.8,3.5,5.3,4.2,5.2,5.2],
              borderColor: purple, backgroundColor: 'rgba(108,92,231,0.08)', fill: true, tension: 0.35,
              pointBackgroundColor: purple, pointRadius: 4, pointHoverRadius: 6 },
            { label: 'FY2024', data: [2.5,2.6,3.0,2.9,3.1,3.4,3.1,2.9,3.8,3.4,4.0,4.5],
              borderColor: grey, borderDash: [5,3], backgroundColor: 'transparent', fill: false, tension: 0.35,
              pointBackgroundColor: grey, pointRadius: 3 },
          ],
        },
        options: {
          responsive: false,
          plugins: { title: { display: true, text: 'Monthly Revenue Trend ($M)', font: { size: 14, weight: '600' }, color: navy } },
          scales: {
            y: { beginAtZero: true, ticks: { callback: function (v) { return '$' + v + 'M'; } }, grid: { color: '#f0f0f0' } },
            x: { grid: { display: false } },
          },
        },
      });
    }

    /* ── 3. Product Revenue (doughnut) ── */
    var pCtx = document.getElementById('productChart');
    if (pCtx) {
      productChartInst = new Chart(pCtx, {
        type: 'doughnut',
        data: {
          labels: ['Enterprise SaaS', 'Pro (Self-Serve)', 'Professional Services', 'Marketplace & Add-ons'],
          datasets: [{ data: [25.1, 12.5, 6.3, 4.3], backgroundColor: [purple, teal, coral, blue], borderWidth: 2, borderColor: '#fff', hoverOffset: 6 }],
        },
        options: {
          responsive: false, cutout: '55%',
          animation: { duration: 300 },
          plugins: {
            title: { display: true, text: 'Revenue by Product Line ($M)', font: { size: 14, weight: '600' }, color: navy },
            legend: { position: 'right' },
            tooltip: { callbacks: { label: function (ctx) { return ctx.label + ': $' + ctx.parsed.toFixed(1) + 'M (' + Math.round(ctx.parsed / 48.2 * 100) + '%)'; } } },
          },
        },
      });
    }

    /* ── 4. Regional Revenue (horizontal bar) ── */
    var rCtx = document.getElementById('regionChart');
    if (rCtx) {
      regionChartInst = new Chart(rCtx, {
        type: 'bar',
        data: {
          labels: ['North America', 'EMEA', 'Asia-Pacific', 'Latin America'],
          datasets: [{ label: 'Revenue ($M)', data: [27.9, 10.4, 6.8, 3.1], backgroundColor: [purple, teal, blue, coral], borderRadius: 4, barPercentage: 0.6 }],
        },
        options: {
          responsive: false, indexAxis: 'y',
          animation: { duration: 300 },
          plugins: {
            title: { display: true, text: 'Revenue by Region ($M)', font: { size: 14, weight: '600' }, color: navy },
            legend: { display: false },
          },
          scales: {
            x: { beginAtZero: true, ticks: { callback: function (v) { return '$' + v + 'M'; } }, grid: { color: '#f0f0f0' } },
            y: { grid: { display: false } },
          },
        },
      });
    }

    /* ── Lock computed cells ── */
    lockFx();

    /* ── Initial recalc (sync chart data with table) ── */
    recalcQuarterly();
    recalcProduct();
    recalcRegion();

    /* ── Bind live table events ── */
    var qt = document.getElementById('quarterly-table');
    var pt = document.getElementById('product-table');
    var rt = document.getElementById('region-table');
    if (qt) qt.addEventListener('input', recalcQuarterly);
    if (pt) pt.addEventListener('input', recalcProduct);
    if (rt) rt.addEventListener('input', recalcRegion);
  }

  /* ── Load Chart.js then initialise ── */
  if (typeof window.Chart !== 'undefined') {
    init();
  } else {
    var s = document.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js';
    s.onload = init;
    document.head.appendChild(s);
  }
})();
</script>

</body>
</html>
